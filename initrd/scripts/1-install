#
# By Chih-Wei Huang <cwhuang@linux.org.tw>
#		 Shadichy <shadichy.dev@gmail.com>
# Last updated 2024/10/01
#
# License: GNU Public License
# We explicitely grant the right to use the scripts
# with Android-x86 project.
#

setup_install() {
	mkdir -p /installer /tmp/i_workdir /tmp/i_upperdir
	mount -o loop /mnt/$SRC/installer.?fs /installer
	mount -t overlay \
		-o lowerdir=/installer,upperdir=/tmp/i_upperdir,workdir=/tmp/i_workdir \
		overlay /installer

	mount --move /android /installer/android
	mount --move /mnt /installer/cdrom

	rm -f /system
	ln -s /installer/android/system /
}

start_install() {
	exec ${SWITCH:-switch_root} /installer /sbin/init

	# avoid kernel panic
	while :; do
		echo
		echo '	Android-x86 console shell. Use only in emergencies.'
		echo
		debug_shell fatal-err
	done
}
